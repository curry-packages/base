# directory containing the repository library files:
LIBTRUNKDIR=$(ROOT)/lib-trunk
# get all library files from standard makefile:
LIB_CURRY = `cd $(LIBTRUNKDIR) && $(MAKE) --no-print-directory --quiet -f Makefile.$(CURRYSYSTEM) allsources`
# name of this makefile:
CURRENT_MAKEFILE = $(LIBTRUNKDIR)/Makefile.$(CURRYSYSTEM).install

##########################################################################
# Install the library sources into the Curry system library directory:
.PHONY: install
install:
	mkdir -p $(LIBDIR)
	mkdir -p $(LIBDIR)/meta
	mkdir -p $(LIBDIR)/AbstractCurry
	mkdir -p $(LIBDIR)/FlatCurry/Annotated
	mkdir -p $(LIBDIR)/Database/CDBI
	$(MAKE) -f $(CURRENT_MAKEFILE) $(LIBDIR)/Makefile
	cd $(LIBDIR) && $(MAKE) -f $(CURRENT_MAKEFILE) sources

$(LIBDIR)/Makefile: Makefile.$(CURRYSYSTEM)
	cp $< $@

.PHONY: sources
sources:
	@echo LIB_CURRY=$(LIB_CURRY)
	$(MAKE) -f $(CURRENT_MAKEFILE) $(LIB_CURRY)
	cp -p $(LIBTRUNKDIR)/*.hs .

meta/%.curry: $(LIBTRUNKDIR)/meta/%.curry
	 cp $< $@

AbstractCurry/%.curry: $(LIBTRUNKDIR)/AbstractCurry/%.curry
	cp $< $@

FlatCurry/Annotated/%.curry: $(LIBTRUNKDIR)/FlatCurry/Annotated/%.curry
	cp $< $@

FlatCurry/%.curry: $(LIBTRUNKDIR)/FlatCurry/%.curry
	cp $< $@

Database/CDBI/%.curry: $(LIBTRUNKDIR)/Database/CDBI/%.curry
	cp $< $@

%.curry: $(LIBTRUNKDIR)/%.curry
	 cp $< $@

index.html: $(LIBTRUNKDIR)/index.html.$(CURRYSYSTEM)
	 cp $< $@

